# å¼ºåŒ–ç³»ç»Ÿ V2 - ç»éªŒå‡çº§åˆ¶

## æ”¹åŠ¨æ¦‚è¿°

å°†åŸæœ‰çš„"æ‰è½å¼ºåŒ–å®ç®±"æœºåˆ¶æ”¹ä¸º"ç»éªŒå‡çº§åˆ¶"ï¼Œç©å®¶é€šè¿‡å‡»æ€æ•Œäººè·å¾—ç»éªŒï¼Œå‡çº§åè·å¾—å¼ºåŒ–å¡ç‰‡ã€‚

---

## æ ¸å¿ƒæ”¹åŠ¨

### 1. ç»éªŒç³»ç»Ÿ

**å‡çº§å…¬å¼**ï¼šäºŒæ¬¡å‡½æ•°å¢é•¿
```javascript
å‡çº§æ‰€éœ€å‡»æ€æ•° = 3 + (ç­‰çº§-1) Ã— 0.5 Ã— ç­‰çº§
```

| å¼ºåŒ–ç­‰çº§ | æ‰€éœ€å‡»æ€æ•° | ç´¯è®¡å‡»æ€æ•° |
|---------|-----------|-----------|
| 1 â†’ 2   | 3         | 3         |
| 2 â†’ 3   | 4         | 7         |
| 3 â†’ 4   | 6         | 13        |
| 4 â†’ 5   | 9         | 22        |
| 5 â†’ 6   | 13        | 35        |
| 6 â†’ 7   | 18        | 53        |
| 7 â†’ 8   | 24        | 77        |
| 8 â†’ 9   | 31        | 108       |
| 9 â†’ 10  | 39        | 147       |
| 10 â†’ 11 | 48        | 195       |

### 2. æ¸¸æˆæµç¨‹

```
å‡»æ€æ•Œäºº â†’ è·å¾—ç»éªŒ
    â†“
ç»éªŒæ»¡ â†’ å‡çº§ï¼ˆæ˜¾ç¤ºå‡çº§æç¤ºï¼‰
    â†“
æ‰“å¼€å¼ºåŒ–é€‰æ‹©ç•Œé¢ â†’ é€‰æ‹©å¼ºåŒ–
    â†“
åº”ç”¨å¼ºåŒ– â†’ ç»§ç»­æˆ˜æ–—
```

### 3. HUD æ˜¾ç¤º

åœ¨å³ä¸Šè§’æ–°å¢å‡çº§è¿›åº¦æ¡ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‡çº§ Lv.2 2/4      â”‚ â† é‡‘è‰²è¿›åº¦æ¡
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚ â† è¿›åº¦å¯è§†åŒ–
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. æ‰è½ç³»ç»Ÿ

**ç§»é™¤**ï¼šå¼ºåŒ–å®ç®±æ‰è½

**ä¿ç•™**ï¼š
- ğŸ’ æ°´æ™¶ï¼ˆ15%æ¦‚ç‡ï¼‰
- ğŸ’š ç”Ÿå‘½æ¢å¤ï¼ˆ15%æ¦‚ç‡ï¼‰
- ğŸ›¡ï¸ æŠ¤ç›¾ï¼ˆ15%æ¦‚ç‡ï¼‰
- ğŸ›¸ æŠ¤å«æœºï¼ˆ15%æ¦‚ç‡ï¼‰
- æ­¦å™¨ï¼ˆ40%æ¦‚ç‡ï¼‰

---

## ä¿®æ”¹çš„æ–‡ä»¶

### 1. js/runtime/databus.js

**æ–°å¢å±æ€§**ï¼š
```javascript
this.upgradeLevel = 1        // å¼ºåŒ–ç­‰çº§
this.upgradeExp = 0         // å½“å‰ç»éªŒå€¼
this.killsThisLevel = 0      // æœ¬çº§å‡»æ€æ•°
```

**æ–°å¢æ–¹æ³•**ï¼š
```javascript
// è®¡ç®—å‡çº§æ‰€éœ€çš„ç»éªŒå€¼ï¼ˆäºŒæ¬¡å‡½æ•°å¢é•¿ï¼‰
getUpgradeExpRequired()

// æ·»åŠ ç»éªŒå€¼ï¼Œè¿”å›æ˜¯å¦å‡çº§
addUpgradeExp(amount = 1)
```

### 2. js/runtime/battle.js

**ç§»é™¤**ï¼š
- å¼ºåŒ–å®ç®±æ‰è½é€»è¾‘

**æ–°å¢**ï¼š
- å‡»æ€æ•Œäººè·å¾—ç»éªŒ
- å‡çº§åè‡ªåŠ¨æ‰“å¼€å¼ºåŒ–é€‰æ‹©ç•Œé¢
- `openUpgradeSelection()` æ–¹æ³•

**ä¿®æ”¹**ï¼š
- `handleDrop()` æ”¹ä¸ºå¤„ç†å…¶ä»–ç±»å‹çš„æ‰è½ï¼ˆé“å…·ã€æ­¦å™¨ç­‰ï¼‰
- Boss ä¸ç»™ç»éªŒï¼ˆé¿å…å¿«é€Ÿåˆ·ç­‰çº§ï¼‰

### 3. js/runtime/props.js

**ä¿®æ”¹**ï¼š
- `Drop` ç±»æ”¹ä¸ºéšæœºæ‰è½é“å…·
- ç§»é™¤ `type: 'upgrade'` çš„å¼ºåŒ–å®ç®±

### 4. js/runtime/ui.js

**æ–°å¢**ï¼š
- HUD ä¸­çš„å‡çº§è¿›åº¦æ¡
  - é‡‘è‰²è¿›åº¦æ¡æ˜¾ç¤ºå½“å‰ç»éªŒè¿›åº¦
  - æ–‡æœ¬æ˜¾ç¤ºï¼šå‡çº§ Lv.X å½“å‰/æ‰€éœ€

---

## æ¸¸æˆä½“éªŒæ”¹è¿›

### åŸç³»ç»Ÿï¼ˆæ‰è½åˆ¶ï¼‰
- âŒ ä¾èµ–è¿æ°”
- âŒ å¯èƒ½å¾ˆä¹…æ‰ä¸åˆ°å¼ºåŒ–
- âŒ æ‰è½åè¿˜å¾—å»æ‹¾å–
- âŒ å°æ€ªå’ŒBossæ‰è½æ¦‚ç‡ä¸åŒ

### æ–°ç³»ç»Ÿï¼ˆå‡çº§åˆ¶ï¼‰
- âœ… å¯é¢„æœŸçš„æˆé•¿è·¯å¾„
- âœ… æ¯æ¬¡å‡çº§å¿…å¾—å¼ºåŒ–
- âœ… å‡»æ€æ•°æ¸…æ™°å¯è§
- âœ… æ‰€æœ‰æ•Œäººè´¡çŒ®ç›¸åŒ

---

## å¹³è¡¡æ€§è€ƒè™‘

### ç»éªŒå¢é•¿æ›²çº¿
é‡‡ç”¨äºŒæ¬¡å‡½æ•°ï¼Œå‰æœŸå¿«åæœŸæ…¢ï¼š
- å‰3çº§ï¼šå¿«é€Ÿæˆé•¿ï¼Œä½“éªŒå¼ºåŒ–ä¹è¶£
- ä¸­æœŸï¼šèŠ‚å¥é€‚ä¸­ï¼Œé€æ­¥æå‡
- åæœŸï¼šéœ€è¦æ›´å¤šå‡»æ€ï¼Œå»¶é•¿æ¸¸æˆæ—¶é•¿

### å¼ºåŒ–ç­‰çº§ä¸Šé™
- 6å¤§æµæ´¾ï¼Œæ¯ä¸ªæµæ´¾æœ€é«˜5çº§
- ç†è®ºéœ€è¦30æ¬¡å‡çº§
- ç´¯è®¡å‡»æ€çº¦195ä¸ªæ•Œäººï¼ˆä¸å«Bossï¼‰

### æˆ˜æ–—èŠ‚å¥
- å°å…³ï¼ˆ60ç§’ï¼‰ï¼šçº¦å‡»æ€20-30ä¸ªæ•Œäºº
- å¯è·å¾—çº¦1-2æ¬¡å‡çº§æœºä¼š
- é…åˆBossæˆ˜æ–—ï¼Œæ•´ä½“èŠ‚å¥å¹³è¡¡

---

## æŠ€æœ¯ç»†èŠ‚

### ç»éªŒè®¡ç®—
```javascript
addUpgradeExp(amount = 1) {
  const required = this.getUpgradeExpRequired()

  if (this.killsThisLevel + amount >= required) {
    this.killsThisLevel = 0
    this.upgradeLevel++
    return true  // å‡çº§äº†
  } else {
    this.killsThisLevel += amount
    return false  // æœªå‡çº§
  }
}
```

### å‡çº§è§¦å‘
```javascript
// å‡»æ€æ•Œäººæ—¶
const leveledUp = databus.addUpgradeExp(1)

if (leveledUp) {
  this.addFloatingText(`å¼ºåŒ–ç­‰çº§æå‡! Lv.${databus.upgradeLevel}`, ...)
  this.openUpgradeSelection()
}
```

### è¿›åº¦æ¡æ¸²æŸ“
```javascript
const expRequired = databus.getUpgradeExpRequired()
const expProgress = databus.killsThisLevel / expRequired

// ç»˜åˆ¶è¿›åº¦æ¡
ctx.fillStyle = '#ffd700'
ctx.fillRect(barX, barY, barWidth * expProgress, barHeight)
```

---

## æœªæ¥æ‰©å±•å»ºè®®

1. **Bosså¥–åŠ±ç»éªŒ**
   - Boss å‡»è´¥ç»™äºˆé¢å¤–ç»éªŒ
   - ä¾‹å¦‚ï¼šBoss = 5 ä¸ªå°æ€ªçš„ç»éªŒ

2. **è¿å‡»ç³»ç»Ÿ**
   - å¿«é€Ÿå‡»æ€è·å¾—ç»éªŒåŠ æˆ
   - ä¾‹å¦‚ï¼šè¿å‡» Ã— æ¯è¿å‡»+0.1ç»éªŒ

3. **éš¾åº¦é€‚é…**
   - é«˜çº§æ•Œäººç»™äºˆæ›´å¤šç»éªŒ
   - ä¾‹å¦‚ï¼šä¸­æ€ª 2ç»éªŒï¼Œå°æ€ª 1ç»éªŒ

4. **ç»éªŒæ± æ˜¾ç¤º**
   - æ˜¾ç¤ºåˆ°ä¸‹ä¸€çº§è¿˜éœ€è¦å¤šå°‘å‡»æ€
   - ä¾‹å¦‚ï¼šè¿˜éœ€ 2 ä¸ªæ•Œäººå‡çº§

---

## ç‰ˆæœ¬å†å²

- v2.0 (2026-02-13)
  - ä»æ‰è½åˆ¶æ”¹ä¸ºç»éªŒå‡çº§åˆ¶
  - æ·»åŠ äºŒæ¬¡å‡½æ•°ç»éªŒå¢é•¿æ›²çº¿
  - æ–°å¢å‡çº§è¿›åº¦æ¡UI
  - ç§»é™¤å¼ºåŒ–å®ç®±æ‰è½
